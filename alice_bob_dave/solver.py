from Crypto.Util.number import *
ct_a=1991374644522844726604723395302447678829362766488998002689642863876589167224123634868869407586265887639572846618361378190717796457675877867002990630200549839187693737176043693114429036857443618075597595356236777647214186597416429862630588853297534066191784060030827904725960955181749644590885127762513958644117342351741609981560458367036971039921421548984093411630930209440031060634872093143755813835906517674672118355461511837533783279547447855290393938723966500874359457216314821548439555245649159786182924722770460929014017979622168454175758261065999271764594369618940918533185330319317089809708951104047147411596
ct_b=11560415492145861207516424108577715664730529386805857287246533744961821151018194362544284902991666685182413092786353089517543091603274250128250910669110530206320138191614471688310529571895441809729559056935543845898702106837033971935287923495445981173899073238286288875669342754013550227359718814123485311705960547980778357375585882146296937739196745327987012437076826111202650212821723168353665944362122152786549834258495316372518691633486765982945106049194892430437710982481105051765183397588927444843790029563399175420351710322220501327577415113508236805750358567711052779340011355629159610689505604941700815518380
d_a=12007894588345817095001901772235818535532128075248502006167506715501613386280619988757005912270381074208611126718938214462213079931302423653355153363846803336576965899104058007549509604040316897464770127372797630135493394807353800174267249408200186888724103432412296802728616667116382243738519746110159825921676647202689661952040602841752466515868580858475210918168761862255041985423595605698941150797550252491451770611246462256935118062094973933183288422900540413805923476283359196218128607678993284504582128505198491110084905108072190837781925478455984417366202863689318005069821086805269764308054632708127147397685
d_b=15309121030008789112453654624398278092026139678301334759817236349957760197277968332173160272007689043235997494440248487531238644015060915059836861728115118555482791561589562225055947155368216166612774271639118879220806859714069050410034235487298164832205885978355955618431606156727831992132535894020870312453902803351757466444078059503362362343138846985263572980446344678973847354860739168547872456538618897496981232096868408852088578700314051200160980186449222946973789039336701174360592471866811887750298968395798446811465432587371913161943176018766518394820191044593922558127924048562996714970537749736086175516533
e=65537
pa=[ 2,2,3,3,17,1543,28477,36097,446123,1014259,1791708059190763337913739704878154903549208836023869327111996333935897967547426273005382575331249273716725696953812061164631436716813643247515568549909883300757852047169964276981270441422966783346053999744959795529500560287285580791785741646278213008211075297800758789603784448566872199024264077059984409486455171555015045912002446817763575199648828609322143810708068603411261129819412019145062202953079744568614208496066992203673804828971903623300181997485344639245001597887304208523603213828214608473119132574331021809855785216168265219928679385661619616475842473713655205197765444388352283023]
pb=[ 2,2,3,3,5,7,7,1061,1543,36097,1014259,1897872090397906665708631675606507738040824494173818669990523169918982682236775477255301788707933079967227071288873394499077626148951960237285359008528659757477732652059901961300390574538625325566100407708054914081563546038167129534809153786142968479549682440854328660634762173307274679394080020928115017765502011624462025428694457739931327826441231672107259897876367053024653400366046405647925174091177914622065084531460111664598632078173323330100018007321901086352438988633813017181005067092042707395352100540602519925195427706316759213814494479322686644392944803386391760541809477241419409026785449]
import math
c = math.gcd(e*d_a-1,e*d_b-1)
print(c)
pp = [ 2,2,3,3,1543,36097,1014259,17275267,33878479,64555363525704839503363,13843294374590501153575359748767274126053352729479537741977678154837940367725830968854964957283527886754718756686680847922782086222027205796563115693252960446483090290176656020345895604792952692850026400036720222060460108513404092975304800801154763470020377]
import sympy
p = 177279130816191665059944783286411855023035031289227941571673915784074353287733189099688126318264113305321082059619767094038966996649561164342515779196140056547333435193040798074799909334916510316728847254833619137382153503950749154356946058670079132324988450725735937306884337410304401871741381990982764516163
"""
for i in range(pow(2,len(pp))):
	cc = bin(i)[2:]
	while len(cc) < len(pp): cc = "0" + cc
	np = 1
	for j in range(len(cc)):
		if cc[j] == "1": np*=pp[j]
	if sympy.isprime(np+1) and len(bin(np+1)[2:]) == 1024:
		print("Found!")
		print(np+1)
	
p = 177279130816191665059944783286411855023035031289227941571673915784074353287733189099688126318264113305321082059619767094038966996649561164342515779196140056547333435193040798074799909334916510316728847254833619137382153503950749154356946058670079132324988450725735937306884337410304401871741381990982764516163177279130816191665059944783286411855023035031289227941571673915784074353287733189099688126318264113305321082059619767094038966996649561164342515779196140056547333435193040798074799909334916510316728847254833619137382153503950749154356946058670079132324988450725735937306884337410304401871741381990982764516163
"""
#print(len(bin(e*d_a-1)[2:]))
#print(len(bin(e*d_b-1)[2:]))
qq = (e*d_a-1)%(p-1)
rr = (e*d_b-1)%(p-1)

print(qq)
print(rr)
m1 = pow(ct_a,d_a,p)
m2 = pow(ct_b,d_b,p)
print(long_to_bytes(m1))
print(long_to_bytes(m2))
	
